[
  %% air config
  {air, [
    % settings for HTTP endpoint
    {web_server, [
      {ip, "0.0.0.0"}
    ]},

    % sandbox settings
    {air_sandbox, [
      {task_timeout, 30000}
    ]},
    {tasks, [
      {purge_cron_spec, {daily, {0, 0, 0}}},

      % Regularly scheduled integration tests
      {full_cluster_test, {weekly, sat, {1, am}}}
    ]}
  ]},

  %% airpub config
  {airpub, [
    % the ip on which airpub will listen for http connections
    {http_ip, {127, 0, 0, 1}},
    % the maximum size (in bytes) of a published article
    {max_article_size, 25165824}, % 24 MB
    % the validity period (in seconds) of a request generated by web
    {request_expiration_period, 120},
    % the time (in seconds) to keep an article in history
    {publish_history_size, 30}
  ]},

  %% Overrides settings from default cloak config
  {cloak_overrides, [
    {in_development, false},
    {job_inserter, [
      {validation_module, job_insert_mock},
      {insert_module, job_insert_mock}
    ]},
    {cloak_db, [
      % We won't use the default connection
      {connection, []},
      % Per-server connection pool sizes. Each tuple defines number of static (started immediately and
      % persisted), and dynamic workers (started on demand and terminated when done) in the pool
      {pool_size, [
        {default, {20, 0}}
      ]}
    ]},
    {global_service, [
      %% M:F for providing list of default nodes for global service
      {default_nodes, {cloak_util, all_visible_nodes}}
    ]}
  ]},

  %% Lager Config
  {lager, [
    {handlers, [
      {lager_console_backend,
        [info, {lager_default_formatter, [time," [",severity,"] ", message, "\n"]}]
      }
    ]},

    %% disable lager crash log
    {crash_log, undefined},

    %% Get coloured output with Erlang R16B and newer (if lager >= 2)
    {colored, true},

    %% disable lager error_logger connector
    {error_logger_redirect, false}
  ]},

  %% SASL config
  {sasl, [
    {sasl_error_logger, {file, "log/sasl-error.log"}},
    {errlog_type, error},
    {error_logger_mf_dir, "log/sasl"},      % Log directory
    {error_logger_mf_maxbytes, 10485760},   % 10 MB max file size
    {error_logger_mf_maxfiles, 5}           % 5 files max
  ]}
].
