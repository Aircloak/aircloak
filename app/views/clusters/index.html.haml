%h1 Listing clusters

- if @clusters.size > 0 then
  %table.table.table-striped
    %thead
      %tr
        %th Name
        %th TPM
        %th Build
        %th Number of cloaks
        - Cloak.health_types.each do |type|
          %th= "# in state #{type}"
        %th Health
        %th
        %th
        %th

    %tbody
      - @clusters.each do |cluster|
        - health = cluster.health_of_cloaks
        %tr
          %td= cluster.name
          %td= cluster.tpm
          %td= cluster.build.name
          %td= cluster.cloaks.count
          - Cloak.health_types.each do |type|
            %th= health[type]
          %td= cluster.health
          %td= link_to 'Show', cluster
          %td= link_to 'Edit', edit_cluster_path(cluster)
          %td
            - if cluster.can_destroy?
              = link_to 'Destroy', cluster, :method => :delete, :data => { :confirm => 'Are you sure?' }
            - else
              Build currently in use

%h4 Add a new cluster
= render 'form'
