%h1 Tables

%hr

- if @clusters.inject(0) {|a,c| a + AnalystTable.live_for_cluster(c).count} == 0
  %strong No tables exist yet
- else
  - @clusters.each do |cluster|
    %h2= cluster.name

    %table.table.table-condensed
      %thead
        %tr
          %th Name
          %th
      %tbody
      - AnalystTable.live_for_cluster(cluster).each do |table|
        %tr
          %td= table.table_name
          %td
            - if table.pending_migrations?
              pending migration
              = link_to 'Retry', retry_migration_table_path(table), method: :post, class: "btn btn-mini"
            - else
              = link_to 'Edit', edit_table_path(table), class: "btn btn-mini"
              = link_to 'Drop table', table_path(table), :method => :delete, :data => { :confirm => 'Are you sure?' }, class: "btn btn-mini btn-danger"

= link_to "Create table", new_table_path, class: "btn btn-mini"
