{
  "type": "object",
  "properties": {
    "name": {"type": "string", "minLength": 1},
    "use_staging_license_key": {"type": "boolean", "$comment": "allowed for backward compatibility"},

    "database": {
      "type": "object",
      "properties": {
        "host": {"type": "string", "minLength": 1},
        "port": {"type": "integer", "minimum": 1},
        "ssl": {"type": "boolean"},
        "user": {"type": "string", "minLength": 1},
        "password": {"type": "string"},
        "name": {"type": "string", "minLength": 1}
      },
      "additionalProperties": false,
      "required": ["host", "user", "name"]
    },

    "shadow_database": {
      "type": "object",
      "properties": {
        "host": {"type": "string", "minLength": 1},
        "port": {"type": "integer", "minimum": 1},
        "ssl": {"type": "boolean"},
        "user": {"type": "string", "minLength": 1},
        "password": {"type": "string"},
        "name": {"type": "string", "minLength": 1}
      },
      "additionalProperties": false,
      "required": ["host", "user", "name"]
    },

    "site": {
      "type": "object",
      "properties": {
        "auth_secret": {"type": "string", "minLength": 60},
        "endpoint_key_base": {"type": "string", "minLength": 64},
        "endpoint_public_url": {"type": "string"},
        "cloak_secret": {"type": "string", "minLength": 64},
        "api_token_salt": {"type": "string", "$comment": "allowed for backward compatibility"},
        "master_password": {"type": "string", "minLength": 1},
        "certfile": {"type": "string"},
        "keyfile": {"type": "string"},
        "use_staging_license_key": {"type": "boolean", "$comment": "allowed for backward compatibility"},
        "customer_token": {"type": "string", "minLength": 1, "$comment": "allowed for backward compatibility"},
        "alternate_aircloak_central": {"type": "string", "$comment": "allowed for backward compatibility"},
        "license_file": {"type": "string", "$comment": "allowed for backward compatibility"},
        "privacy_policy_file": {"type": "string", "$comment": "path to privacy policy content"},
        "users_and_datasources_file": {"type": "string", "$comment": "path to user and data sources content"},
        "browser_long_polling": {"type": "boolean"}
      },
      "additionalProperties": false,
      "required": ["auth_secret", "endpoint_key_base", "master_password"]
    },

    "psql_server": {
      "type": "object",
      "properties": {
        "require_ssl": {"type": "boolean"},
        "certfile": {"type": "string", "minLength": 1},
        "keyfile": {"type": "string", "minLength": 1},
        "max_connections": {"type": "integer", "minimum": 1}
      },
      "additionalProperties": false,
      "required": ["require_ssl"]
    },

    "ldap": {
      "type": "object",
      "properties": {
        "host": {"type": "string"},
        "port": {"type": "number"},
        "bind_dn": {"type": "string"},
        "password": {"type": "string"},
        "encryption": {"type": "string", "enum": ["plain", "ssl", "start_tls"]},
        "verify_server_certificate": {"type": "boolean"},
        "ca_certfile": {"type": "string", "minLength": 1},
        "client_certfile": {"type": "string", "minLength": 1},
        "client_keyfile": {"type": "string", "minLength": 1},
        "user_base": {"type": "string", "minLength": 1},
        "user_name": {"type": "string", "minLength": 1},
        "user_login": {"type": "string", "minLength": 1},
        "user_filter": {"type": "string", "minLength": 1},
        "group_base": {"type": "string", "minLength": 1},
        "group_filter": {"type": "string", "minLength": 1},
        "group_name": {"type": "string", "minLength": 1},
        "group_member": {"type": "string", "minLength": 1},
        "group_member_key": {"type": "string", "enum": ["login", "dn"]},
        "user_group": {"type": "string", "minLength": 1}
      },
      "additionalProperties": false,
      "required": ["host", "user_base", "group_base"]
    },

    "explorer": {
      "type": "object",
      "properties": {
        "url": {"type": "string"}
      },
      "additionalProperties": false,
      "required": ["url"],
      "uniqueItems": true
    }
  },
  "additionalProperties": false,
  "required": ["name", "database", "site"]
}
